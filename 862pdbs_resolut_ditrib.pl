#!/usr/bin/env perl
#
#
use strict;
use warnings;

my $flag =0;
my $xray=0;
my $nmr=0;
my $higher_res=99;
my $lower_res=0;
my %pdb_res_expttype=();
my %resolution_dist=();
my @resolutions;

######################
open(I,"/aloy/data/dbs/pdbmirror/derived_data/index/entries.idx") or die;
while(<I>){
  unless ($flag<=1){
    my @fields = split("\t",$_);
    ## {pdbid}=resolution
    $pdb_res_expttype{$fields[0]}=$fields[6];
  }
  $flag++; # avoiding 2 firsts lines of entries_2010-05-21.idx file
}
close(I);
######################

######################
foreach (<DATA>){
  chomp;
  my $pdbtemplate = uc($_);
  if(exists $pdb_res_expttype{$pdbtemplate}){
    if($pdb_res_expttype{$pdbtemplate} ne "NOT"){
      $xray++;
      $higher_res=$pdb_res_expttype{$pdbtemplate} if($pdb_res_expttype{$pdbtemplate} < $higher_res);
      $lower_res=$pdb_res_expttype{$pdbtemplate} if($pdb_res_expttype{$pdbtemplate} > $lower_res);
      ## {resolution}=count
      $resolution_dist{$pdb_res_expttype{$pdbtemplate}}++;
      push(@resolutions,$pdb_res_expttype{$pdbtemplate});
      
    }else{
      $nmr++;
    }
  }else{
    #print "$pdbtemplate missing from entries-file\n";
  }
}
#print "Xray: $xray\n NMR: $nmr\n";
#foreach (sort {$a <=> $b} keys %resolution_dist){
#  print "$_\t$resolution_dist{$_}\n";
#}
######################

######################
my $ranges=20;
my $shift=((($lower_res+0.01)-$higher_res)/$ranges);
my $bottom=$higher_res;
my $top=0;
my %resolution_dist_clustered=();

for(my $i=1;$i<=$ranges;$i++){
  $top = ($higher_res + ($shift*$i));
  my $cluster = $bottom."-".$top;

  foreach my $res (@resolutions){
    if($bottom <= $res && $res < $top){
      $resolution_dist_clustered{$cluster}++;
    }
  }
  $bottom = (($higher_res + ($shift*$i))+0.001);
}

foreach (sort {$a cmp $b} keys %resolution_dist_clustered){
  print "$_\t$resolution_dist_clustered{$_}\n";
}
######################


### 862 PDBs templates of HPKDs
__DATA__
1q8t
2oj9
2e14
1syk
1svg
2gu8
3dk6
2brh
3da6
1opl
1oiy
1ckj
1okw
3cgo
2j5e
1okz
3h9o
3eqr
1w83
3itz
1pxo
3elj
3bwj
2c3l
1yhv
2j2i
2uvz
2v22
1o6k
1m7q
3mvj
2yza
1nvq
1pyx
2phk
2hxq
2jit
1rej
1xh6
1gng
2vag
1pw2
1jwh
3mb6
1fq1
2wih
2gnj
2wxv
2gnh
1b39
2itw
1ctp
2g2f
1wbv
3c9w
3e7o
1xh9
2o3p
3g9n
2w1c
1nvs
2r3r
1ykr
2wb8
2e9v
2c5n
2cpk
1j1c
1wbt
3f5x
1ydr
3k5v
2c5x
3dfc
2rf9
1fvv
2nru
2qur
1pjk
2v55
3g2f
1o6l
2c6m
3cxw
2w1f
3ik3
3erk
2v7o
3fy2
3fhi
3f7z
2c6l
3lxn
3e87
3fmd
2jds
3fjq
1xh5
2itn
1okv
3io7
3gu4
2oib
3kq7
2j0l
2brn
2uw6
2pe1
2o64
2ayp
2wpa
3cqw
2j7t
2itz
1jks
2v7a
1m17
3eqp
2x1n
2gnl
2auh
3e7v
2c3j
1ol2
2z60
2wgj
2h8h
1jkk
2c6k
2uze
3eyh
2o5k
1qpc
1yxs
2bpm
1z57
1k9a
1ol1
1wvw
2wot
3fwq
1pxj
2iw9
3krw
2g2h
2itt
1wbw
3g90
1gag
1q3w
3fc2
2r4b
2e9u
1pxk
2vnw
1ol5
2jbo
1oiu
2pe2
2gng
3fzt
1zlt
2w1d
3gvu
3e3b
3fup
2f57
2qr8
2r3h
1xo2
2jdo
2o65
1uu8
1hck
3eid
2wu6
2bdf
2p33
2gmx
1irk
2g01
2eva
2qoc
2e9o
2hzi
3h30
3fxz
2brg
2uw7
2uzw
1wvy
3a7f
2x4f
2fys
2biy
2vtm
1m7n
1jow
1oi9
1jbp
3hrf
2hz4
2bdj
3gu6
2b54
3cy2
2izr
2v62
3cd3
1f5q
2zm3
3ggf
1h1w
2c3i
2vd5
3cbl
1xh7
1e9h
2h96
1p4f
3e88
2wtw
1pmv
2vx3
2wmr
2np8
2itu
2hck
3lxp
3fqe
3gu8
2w4j
1qmz
2w5h
3js2
3bu3
1di9
3f88
3kb7
1vzo
3iec
1xws
2wzj
3mv5
2pzy
1yxv
1na7
3hmm
1w98
2zkj
3jy0
1ydt
1j1b
1ir3
3cy3
1m14
2gfc
2wel
1u59
1r0p
1pmq
1rw8
3dgk
1muo
1q4l
2gdo
1j3h
1ig1
2izs
1q61
3ma3
2rfe
2r3i
2c6i
2z7l
2no3
2vn9
3mfr
1jkt
3mb7
2r3p
2g2i
1bkx
2etm
1unh
2etk
1ol7
2f2u
1q3d
1qpe
2euf
2br1
1h27
3dlz
2j51
3c0g
3dog
3ms9
3kex
1g3n
2wtv
1qpd
2uw9
2f7x
2izt
2w1e
2zm1
1k2p
2c47
2jgz
3eyg
2w4k
1h26
1wbo
3bqr
3cs9
2a2a
2f7z
1bl7
2vny
3ej1
1yxt
3com
3lpb
2ity
1pkd
1pxi
1yi6
3et7
2gqg
3d0e
2ywp
3fqh
3emg
2a4l
2jdr
3bht
1pmu
3d7u
2j6m
3e5a
3dak
3fpq
2x0g
3eoc
2j0j
1a9u
2etr
1fin
1szm
2hy8
1pmn
2jfm
1z5m
1k3a
3lm0
2bmc
2uzu
1veb
1uwj
2r3g
2gs6
2eb2
1bl6
3e62
2bcj
1xh4
1o9u
3kmw
2acx
1oir
1omw
1m52
3c0h
3f5u
2r3q
3kvw
2hz0
2pvy
2o63
2vuw
1h28
2oji
1p5e
1ia9
1tvo
2zyb
1cmk
2ojg
2uvy
2qhm
1urc
2erz
2uw4
2vtl
1u4d
1jqh
2jdt
3dne
2exm
1b6c
2cgu
1xba
2rku
2vtr
3hdn
1xbc
2h9v
1zzl
2zb0
2wev
2of2
1xha
3ddq
1stc
1ksw
3mfu
1pxm
2itq
1uu3
3mss
3byo
1xh8
3gen
1xr1
3jya
2cke
1uwh
3bhy
2clq
1l3r
2hk5
1jst
3dqw
3krx
2g1t
2hxl
1smh
3fz1
2uw3
2gni
1h25
1qpj
3gxl
3lfs
3cgf
3ekn
2hog
3lm5
2gs7
3mtf
1f3m
2a0c
1gz8
2b7a
1wbs
1atp
3a8x
3kxx
1q24
3mfs
3f5g
2qlu
2clx
1i09
1ouy
1rdq
3bhu
2uw8
1iah
3ddp
1w84
1bx6
3bhv
1jsu
2i40
3bym
2uzv
1pme
1ad5
1sve
1z9x
3gub
3bu5
1re8
2q8g
2hy0
1uu7
1y91
2jam
3gu5
3lmg
1u5q
2bzj
2uzb
1q62
2vwy
3coi
3a4o
3cqu
2uue
3faa
2gnf
3e8e
1ung
1u54
2f4j
1yhs
2q8h
1xjd
3gp0
3iq7
3bce
2vx0
2w99
3gu7
1yxx
2c5v
2c1b
2vu3
3d9v
3kcf
2cgv
2dq7
1jsv
2bzi
3g33
1q5k
2vwz
2r0u
3ha6
2izu
2cch
2ojj
3fdn
1iep
2ds1
2eu9
2bil
2pvr
1p4o
2oza
1fvr
1yrp
1h1r
2wu7
2r7i
3fzo
1ias
1pxp
2r3o
3f66
2r3f
1zws
1e1x
1r0e
2qcs
1w7h
2itp
1uv5
3dnd
1blx
1jnk
3f2a
1unl
2dwb
3a2c
2waj
2vz6
1h01
3lb7
3mft
1h0v
2w9z
3du8
1phk
1h07
3cik
1wvx
1pxn
1xbb
1buh
1h1p
1uvr
2i0e
2c1a
2itx
1q8w
3i81
1apm
3ky2
2qoh
1ia8
3dk3
2w1i
3i4b
1y57
3fxx
2vo3
3dqx
2j90
1yqj
2esm
1mq4
1pf8
3a7i
3ika
3kul
2vwi
2fvd
1jkl
3lfn
2wd1
2zjw
3mpm
2wnt
2c69
2uzt
4erk
3lck
2bro
2jld
2c6d
3dls
1h24
3dt1
2f7e
3c4e
1ogu
3bkb
3hrc
3d94
2wtk
2b53
2uw0
2w1g
2ghg
1opk
2cmw
3bu6
3jxw
1h4l
2b4s
1y8y
2gs2
2r7b
2wo6
2bzk
1wbn
3bqc
3f9n
2hyy
1xqz
1fpu
2e2b
1oky
2rfd
3gfe
3b2w
1q8u
2psq
3kxz
2j5f
3d4q
1tki
1jlu
2uv2
1ouk
2bik
2c68
3mdy
2hiw
2obj
1h1s
3e7e
2a27
2c5o
1wzy
2zva
2ou7
3bgz
2r2p
2nry
2v0d
2cci
2jii
3cc6
2of4
3eha
1zys
1fmo
2e9p
2jdv
2buj
3f2n
3c13
2brb
2uzd
2vo0
2gcd
2brm
1yi3
2c4g
2cjm
2zdu
2owb
2jiu
1svh
3ii5
2xh5
2ojf
2w5a
1erk
3e63
2uvx
3igg
2vwx
2oi4
3idb
2c6e
3f6x
1gol
1w82
3gc8
3bwf
3k2l
3h10
2v5q
2o0u
3iop
1nvr
2ow3
2itv
3e8d
1yxu
3bgp
3gc9
3ds6
2cgx
1wmk
2wip
2cdz
3kck
3dk7
2vo7
3a7j
3eta
1w8c
3gb2
3fy0
2qvs
2uzl
3dkc
1qcf
3kfa
3hdm
2j4z
2zdt
3juh
2jed
1e1v
2erk
1u5r
3ckx
1uu9
1yhw
3g9l
3e64
2uzo
2chl
2zm4
3bgq
2iw6
2ito
3jpv
2j50
3a7h
2g15
3iw4
3gqi
2e0a
3mia
2c6o
3fzr
3c4f
3bhh
1rqq
3kf4
2c30
2hak
3f5p
2pl0
2g9x
2fb8
3ion
2r5t
2jfl
2qr7
1b38
1pxl
1h8f
2q0n
1cdk
2qhn
1ywv
2ofu
3c0i
3hmi
2x4z
3dcv
2wou
1q41
2fo0
2c6t
3lfq
2z8c
2pe0
1py5
2e9n
2hzn
1h1q
2uw5
3jy9
1vyw
1gy3
3idc
1rek
2zoq
2c3k
3eh9
2w5b
1cki
2iw8
1opj
1vjy
1yi4
3a7g
2x39
1yds
3e8c
2c5y
2vx1
2bkz
2wfy
1ua2
1cm8
1zrz
2q8f
2bzh
2src
2j0i
2vo6
1ym7
3mi9
2oh0
2cgw
1hcl
3iok
3mvh
2gph
3fqs
2whb
